# Template file for '%PKG_NAME%'
_chromeVersion="%CHROME_VERSION%"
_chromeRevision="%CHROME_REVISION%"
_channel="%CHANNEL%"
_baseUrl="%BASE_URL%"

pkgname="%PKG_NAME%"
version=%CHROMEVERSION%
revision=%REVISION%
short_desc="A browser plugin designed for the viewing of premium video content"
maintainer="Enno Boland <eb@s01.de>"
homepage="http://www.google.com/chrome"
license="chrome"
only_for_archs="i686 x86_64"
depends="chromium binutils xz"
repository=nonfree
create_wrksrc=yes

case "${XBPS_TARGET_MACHINE}" in
x86_64)
	_filename=google-chrome-${_channel}_${_chromeVersion}-${_chromeRevision}_amd64.deb
	_chromeChecksum="%CHECKSUM_X64%"
	;;
i686)
	_filename=google-chrome-${_channel}_${_chromeVersion}-${_chromeRevision}_i386.deb
	_chromeChecksum="%CHECKSUM_I686%"
	;;
esac
_chromeUrl="${_baseUrl}/${_filename}"
distfiles="${_chromeUrl}"
checksum="$_chromeChecksum"

do_extract() {
	:
}
do_install() {
	sed \
		-e "s|%CHROME_URL%|${_chromeUrl}|" \
		-e "s|%CHROME_CHECKSUM%|${_chromeChecksum}|" \
			${FILESDIR}/chromium-widevine-vars.sh.in > chromium-widevine-vars.sh
	vinstall chromium-widevine-vars.sh 644 usr/lib/$pkgname
	vlicense ${FILESDIR}/LICENSE
}
